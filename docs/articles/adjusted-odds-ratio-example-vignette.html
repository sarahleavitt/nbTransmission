<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adjusted Odds Ratio Example • nbTransmission</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Adjusted Odds Ratio Example">
<meta property="og:description" content="nbTransmission">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nbTransmission</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/adjusted-odds-ratio-example-vignette.html">Adjusted Odds Ratio Example</a>
    </li>
    <li>
      <a href="../articles/nbTransmission-vignette.html">Introductory tutorial for R Package nbTransmission</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/sarahleavitt/nbTransmission/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Adjusted Odds Ratio Example</h1>
                        <h4 data-toc-skip class="author">Anne N.
Shapiro</h4>
            
            <h4 data-toc-skip class="date">2025-05-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sarahleavitt/nbTransmission/blob/HEAD/vignettes/adjusted-odds-ratio-example-vignette.Rmd" class="external-link"><code>vignettes/adjusted-odds-ratio-example-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>adjusted-odds-ratio-example-vignette.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette will walk you through how to use the package
nbTransmission to estimate adjusted odds ratios for factors associated
with a variable representing transmission in an infectious disease
outbreak. As transmission is not always observable, this variable may be
a proxy for transmission, such as genetic relatedness or results from
contact tracing, but we will refer to it henceforth as cases being
‘linked’ or ‘transmission links.’</p>
<p>This tutorial will focus on using the nbTransmission package to model
odds ratios. If you are new to using the nbTransmission package, we
recommend starting with the vignette “Introductory tutorial for R
Package nbTransmission” (<a href="https://sarahleavitt.github.io/nbTransmission/articles/nbTransmission-vignette.html" class="external-link uri">https://sarahleavitt.github.io/nbTransmission/articles/nbTransmission-vignette.html</a>).</p>
<p>Start by installing nbTransmission if you have not already done so,
and then load the package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">'sarahleavitt/nbTransmission'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sarahleavitt.github.io/nbTransmission/" class="external-link">nbTransmission</a></span><span class="op">)</span></span></code></pre></div>
<p>Set your seed to match results in this tutorial:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p>This package implements an algorithm that takes a dataset of ordered
possible infector-infectee pairs from an infectious disease outbreak and
estimates the relative probability the cases are linked by direct
transmission using naive Bayes (NB) and the odds ratios of covariates
associated with transmission.</p>
<p>To estimate both quantities, we use an iterative estimation
procedure. Because transmission is almost always unobserved, links are
represent probable and not certain transmission events. In this setting,
a given case could have multiple probable links when only one true link
exists. The iterative procedure corrects for this by randomly choosing
one link of all of the possible links to include in the training dataset
multiple times. Multiple iterations allows each probable link a turn to
represent the ‘true’ link. Within each iteration, we also run multiple
cross validation folds to allow each pair in the training set an
opportunity in the prediction dataset (this is more important in
estimating relative probabilities). Final estimates of probabilities and
odds ratios are the average of all estimates for a pair across the cross
validation folds and iterations. For more details on the algorithm and
NB, please see the previous vignette.</p>
</div>
<div class="section level2">
<h2 id="using-nbtransmission-for-modeling">Using nbTransmission for modeling<a class="anchor" aria-label="anchor" href="#using-nbtransmission-for-modeling"></a>
</h2>
<p>A key assumption of NB is that all variables in the model are
independent. Thus, when using nbTransmission to calculate transmission
probabilities or unadjusted odds ratios, one can add as many variables
as one would like into the model without having to worry about variable
selection as in a regression model. However, we use a bootstrapped
logisitic regression model to calculate adjusted odds ratios, meaning we
do need to consider which variables we want in the model to avoid
overfitting.</p>
<p>Many methods exist for model fitting. In this tutorial, we present
just one possible method. In short, we will first estimate unadjusted
odds ratios for each variable, select the variables significant at the
0.1 level, and then rerun the algorithm with the bootstrapped logistic
regression model using just those variables.</p>
</div>
<div class="section level2">
<h2 id="creating-a-dataset-of-pairs">Creating a Dataset of Pairs<a class="anchor" aria-label="anchor" href="#creating-a-dataset-of-pairs"></a>
</h2>
<p>First we need to create the dataset needed to run the iterative
model. Creation of the pairwise dataset and descriptions of all
covariates are covered in detail in the previous vignette.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#load individual level data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pairData</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#create ordered pair level dataset</span></span>
<span><span class="va">pairDataOrdered</span> <span class="op">&lt;-</span> <span class="va">pairData</span><span class="op">[</span><span class="va">pairData</span><span class="op">$</span><span class="va">infectionDate.2</span> <span class="op">&gt;=</span> <span class="va">pairData</span><span class="op">$</span><span class="va">infectionDate.1</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co">#create SNP distances thresholds </span></span>
<span><span class="co">#SNP distances less than 3 are considered transmission links</span></span>
<span><span class="co">#SNP distances greater than 10 are non-transmission links</span></span>
<span><span class="co"># SNP distances 4-10 are considered indeterminate and only used in the prediction dataset</span></span>
<span><span class="va">pairDataOrdered</span><span class="op">$</span><span class="va">snpClose</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">pairDataOrdered</span><span class="op">$</span><span class="va">snpDist</span> <span class="op">&lt;</span> <span class="fl">3</span>, <span class="cn">TRUE</span>,</span>
<span>                                   <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">pairDataOrdered</span><span class="op">$</span><span class="va">snpDist</span> <span class="op">&gt;</span> <span class="fl">10</span>, <span class="cn">FALSE</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="running-the-unadjusted-model">Running the unadjusted model<a class="anchor" aria-label="anchor" href="#running-the-unadjusted-model"></a>
</h2>
<p>Now we can use the function nbTransmission to calculate unadjusted
odds ratios.</p>
<ul>
<li><p><em>indVar</em> is the individual ID of the infector and
infectee. The function looks for that value with the suffix “.1” and
“.2” in the pair data frame (which would have been automatically created
if you used indToPair to create the pair-level data frame).</p></li>
<li><p><em>n</em> specifies the number of cross validation folds within
each iteration.</p></li>
<li><p><em>m</em> specifies the number of times to create the <em>n</em>
cross validation folds within each iteration.</p></li>
<li><p><em>nReps</em> specifies the number of iterations to
run.</p></li>
<li><p><em>orType</em> specifies the type of odds ratio to run. It takes
values ‘univariate’ and ‘adjusted’.</p></li>
</ul>
<p>Recall that we run the <em>n</em> cross validation folds within each
of the <em>nReps</em> iterations, therefore in total you run naive Bayes
nReps * n * m times. <strong>In this tutorial, n and nReps = 5 for
computation speed but both should be at least 10.</strong></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unadjRes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nbProbabilities.html">nbProbabilities</a></span><span class="op">(</span>orderedPair <span class="op">=</span> <span class="va">pairDataOrdered</span>,</span>
<span>                            indIDVar <span class="op">=</span> <span class="st">"individualID"</span>,</span>
<span>                            pairIDVar <span class="op">=</span> <span class="st">"pairID"</span>,</span>
<span>                            goldStdVar <span class="op">=</span> <span class="st">"snpClose"</span>,</span>
<span>                            covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Z1"</span>, <span class="st">"Z2"</span>, <span class="st">"Z3"</span>, <span class="st">"Z4"</span>, <span class="st">"timeCat"</span><span class="op">)</span>,</span>
<span>                            label <span class="op">=</span> <span class="st">"SNPs"</span>, l <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                            n <span class="op">=</span> <span class="fl">5</span>, m <span class="op">=</span> <span class="fl">1</span>, nReps <span class="op">=</span> <span class="fl">5</span>, </span>
<span>                            orType <span class="op">=</span> <span class="st">"univariate"</span><span class="op">)</span></span></code></pre></div>
<p>The results are a list with two data frames. The first contains the
average and scaled relative transmission probabilities; we will not be
using these in this tutorial. The second contains our unadjusted log
odds ratios.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">unadjRes</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ probabilities:'data.frame':   4950 obs. of  7 variables:</span></span>
<span><span class="co">#&gt;   ..$ label     : chr [1:4950] "SNPs" "SNPs" "SNPs" "SNPs" ...</span></span>
<span><span class="co">#&gt;   ..$ pairID    : chr [1:4950] "001_002" "022_003" "015_003" "020_003" ...</span></span>
<span><span class="co">#&gt;   ..$ pAvg      : num [1:4950] 0.8207 0.0508 0.0385 0.0375 0.0339 ...</span></span>
<span><span class="co">#&gt;   ..$ pSD       : num [1:4950] 0.36614 0.00853 0.0141 0.01163 0.01049 ...</span></span>
<span><span class="co">#&gt;   ..$ pScaled   : num [1:4950] 1 0.161 0.122 0.119 0.107 ...</span></span>
<span><span class="co">#&gt;   ..$ pRank     : num [1:4950] 1 1 2 3 4 5 6 7 8 8 ...</span></span>
<span><span class="co">#&gt;   ..$ nEstimates: int [1:4950] 25 25 25 25 25 25 25 25 25 25 ...</span></span>
<span><span class="co">#&gt;  $ estimates    :'data.frame':   17 obs. of  7 variables:</span></span>
<span><span class="co">#&gt;   ..$ label    : chr [1:17] "SNPs" "SNPs" "SNPs" "SNPs" ...</span></span>
<span><span class="co">#&gt;   ..$ level    : chr [1:17] "Z1:0" "Z1:1" "Z2:0" "Z2:1" ...</span></span>
<span><span class="co">#&gt;   ..$ nIter    : int [1:17] 25 25 25 25 25 25 25 25 25 25 ...</span></span>
<span><span class="co">#&gt;   ..$ logorMean: num [1:17] 0 0.122 0 0.712 0 ...</span></span>
<span><span class="co">#&gt;   ..$ logorSE  : num [1:17] NaN 0.323 NaN 0.342 NaN ...</span></span>
<span><span class="co">#&gt;   ..$ logorCILB: num [1:17] NaN -0.5114 NaN 0.0412 NaN ...</span></span>
<span><span class="co">#&gt;   ..$ logorCIUB: num [1:17] NaN 0.755 NaN 1.383 NaN ...</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="unadjusted-model-results">Unadjusted model results<a class="anchor" aria-label="anchor" href="#unadjusted-model-results"></a>
</h2>
<p>The second data frame contains log odds ratios standard errors and
95% confidence intervals describing the contribution of each covariate
value to the probabilities. The log odds ratios represent the
association between the covariates and being transmission links,
modified by the iterative estimation procedure. The standard errors are
estimated using Rubin’s rules, a method developed for multiple
imputation, to summarize the error across the iterations. We can look at
the output in table or graph form:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="co">#Exponentiating the log odds ratios and creating a table of odds ratios</span></span>
<span><span class="va">orTab</span> <span class="op">&lt;-</span> <span class="va">unadjRes</span><span class="op">$</span><span class="va">estimates</span></span>
<span><span class="va">orTab</span><span class="op">$</span><span class="va">orMean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">orTab</span><span class="op">$</span><span class="va">logorMean</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">orTab</span><span class="op">$</span><span class="va">orCILB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">orTab</span><span class="op">$</span><span class="va">logorCILB</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">orTab</span><span class="op">$</span><span class="va">orCIUB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">orTab</span><span class="op">$</span><span class="va">logorCIUB</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">orTab</span><span class="op">$</span><span class="va">Value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"[A-z0-9]+\\:"</span>, <span class="st">""</span>, <span class="va">orTab</span><span class="op">$</span><span class="va">level</span><span class="op">)</span></span>
<span><span class="va">orTab</span><span class="op">$</span><span class="va">Variable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\:[A-z0-9+-&lt;=&gt;]+"</span>, <span class="st">""</span>, <span class="va">orTab</span><span class="op">$</span><span class="va">level</span><span class="op">)</span></span>
<span><span class="va">orTabPrint1</span> <span class="op">&lt;-</span> <span class="va">orTab</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Variable"</span>, <span class="st">"Value"</span>, <span class="st">"orMean"</span>, <span class="st">"orCILB"</span>, <span class="st">"orCIUB"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<div class="section level4">
<h4 id="table-of-contribution-of-covariates">Table of contribution of covariates<a class="anchor" aria-label="anchor" href="#table-of-contribution-of-covariates"></a>
</h4>
<table class="table">
<thead><tr class="header">
<th align="left">Variable</th>
<th align="left">Value</th>
<th align="right">orMean</th>
<th align="right">orCILB</th>
<th align="right">orCIUB</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Z1</td>
<td align="left">0</td>
<td align="right">1.00</td>
<td align="right">NaN</td>
<td align="right">NaN</td>
</tr>
<tr class="even">
<td align="left">Z1</td>
<td align="left">1</td>
<td align="right">1.13</td>
<td align="right">0.60</td>
<td align="right">2.13</td>
</tr>
<tr class="odd">
<td align="left">Z2</td>
<td align="left">0</td>
<td align="right">1.00</td>
<td align="right">NaN</td>
<td align="right">NaN</td>
</tr>
<tr class="even">
<td align="left">Z2</td>
<td align="left">1</td>
<td align="right">2.04</td>
<td align="right">1.04</td>
<td align="right">3.99</td>
</tr>
<tr class="odd">
<td align="left">Z3</td>
<td align="left">1</td>
<td align="right">1.00</td>
<td align="right">NaN</td>
<td align="right">NaN</td>
</tr>
<tr class="even">
<td align="left">Z3</td>
<td align="left">2</td>
<td align="right">1.24</td>
<td align="right">0.54</td>
<td align="right">2.85</td>
</tr>
<tr class="odd">
<td align="left">Z3</td>
<td align="left">3</td>
<td align="right">1.07</td>
<td align="right">0.50</td>
<td align="right">2.29</td>
</tr>
<tr class="even">
<td align="left">Z3</td>
<td align="left">4</td>
<td align="right">0.79</td>
<td align="right">0.33</td>
<td align="right">1.88</td>
</tr>
<tr class="odd">
<td align="left">Z4</td>
<td align="left">1</td>
<td align="right">1.00</td>
<td align="right">NaN</td>
<td align="right">NaN</td>
</tr>
<tr class="even">
<td align="left">Z4</td>
<td align="left">2</td>
<td align="right">0.61</td>
<td align="right">0.33</td>
<td align="right">1.13</td>
</tr>
<tr class="odd">
<td align="left">Z4</td>
<td align="left">3</td>
<td align="right">0.21</td>
<td align="right">0.07</td>
<td align="right">0.64</td>
</tr>
<tr class="even">
<td align="left">timeCat</td>
<td align="left">1</td>
<td align="right">1.00</td>
<td align="right">NaN</td>
<td align="right">NaN</td>
</tr>
<tr class="odd">
<td align="left">timeCat</td>
<td align="left">2</td>
<td align="right">0.70</td>
<td align="right">0.32</td>
<td align="right">1.54</td>
</tr>
<tr class="even">
<td align="left">timeCat</td>
<td align="left">3</td>
<td align="right">0.51</td>
<td align="right">0.19</td>
<td align="right">1.40</td>
</tr>
<tr class="odd">
<td align="left">timeCat</td>
<td align="left">4</td>
<td align="right">0.30</td>
<td align="right">0.09</td>
<td align="right">0.96</td>
</tr>
<tr class="even">
<td align="left">timeCat</td>
<td align="left">5</td>
<td align="right">0.12</td>
<td align="right">0.02</td>
<td align="right">0.76</td>
</tr>
<tr class="odd">
<td align="left">timeCat</td>
<td align="left">6</td>
<td align="right">0.13</td>
<td align="right">0.04</td>
<td align="right">0.38</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="forest-plot-of-contribution-of-covariates">Forest plot of contribution of covariates<a class="anchor" aria-label="anchor" href="#forest-plot-of-contribution-of-covariates"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">orTab</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Value</span>, y <span class="op">=</span> <span class="va">orMean</span>, ymin <span class="op">=</span> <span class="va">orCILB</span>,</span>
<span>                           ymax <span class="op">=</span> <span class="va">orCIUB</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Variable</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Odds ratio with 95% confidence interval"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        strip.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0</span>, vjust <span class="op">=</span> <span class="fl">1</span>, angle <span class="op">=</span> <span class="fl">360</span><span class="op">)</span>,</span>
<span>        axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">10</span>, r <span class="op">=</span> <span class="fl">0</span>, b <span class="op">=</span> <span class="fl">0</span>, l <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="adjusted-odds-ratio-example-vignette_files/figure-html/covarFig-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="identifying-significant-variables-for-the-adjusted-model">Identifying significant variables for the adjusted model<a class="anchor" aria-label="anchor" href="#identifying-significant-variables-for-the-adjusted-model"></a>
</h2>
<p>Note that the confidence intervals generated by nbProbabilities are
95% confidence intervals, meaning the odds ratio is statistically
significant at the 0.05 level if it does not contain 1. We want to
identify odds ratios statistically significant at the 0.10 level for
model selection, so we need to generate 90% confidence intervals. 1.645
is the z-score corresponding to 90% confidence intervals; you can change
this to calculate confidence intervals for whatever value you’d
like.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">orTab</span><span class="op">$</span><span class="va">logor90CILB</span> <span class="op">&lt;-</span> <span class="va">orTab</span><span class="op">$</span><span class="va">logorMean</span> <span class="op">-</span> <span class="fl">1.645</span><span class="op">*</span><span class="va">orTab</span><span class="op">$</span><span class="va">logorSE</span></span>
<span><span class="va">orTab</span><span class="op">$</span><span class="va">logor90CIUB</span> <span class="op">&lt;-</span> <span class="va">orTab</span><span class="op">$</span><span class="va">logorMean</span> <span class="op">+</span> <span class="fl">1.645</span><span class="op">*</span><span class="va">orTab</span><span class="op">$</span><span class="va">logorSE</span></span>
<span><span class="va">orTab</span><span class="op">$</span><span class="va">or90CILB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">orTab</span><span class="op">$</span><span class="va">logor90CILB</span><span class="op">)</span></span>
<span><span class="va">orTab</span><span class="op">$</span><span class="va">or90CIUB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">orTab</span><span class="op">$</span><span class="va">logor90CIUB</span><span class="op">)</span></span></code></pre></div>
<p>We can create an indicator for which associations are significant at
the 0.1 level. We see variables Z2, Z4, and timeCat have significant
associations. We will include these three variables in our adjusted
model.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">orTab</span><span class="op">$</span><span class="va">sig90pctCI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">orTab</span><span class="op">$</span><span class="va">or90CILB</span> <span class="op">&lt;</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">orTab</span><span class="op">$</span><span class="va">or90CIUB</span> <span class="op">&gt;</span> <span class="fl">1</span>, <span class="st">"Not significant"</span>, <span class="st">"Significant"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">orTabPrint2</span> <span class="op">&lt;-</span> <span class="va">orTab</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Variable"</span>, <span class="st">"Value"</span>, <span class="st">"orMean"</span>, <span class="st">"or90CILB"</span>, <span class="st">"or90CIUB"</span>, <span class="st">"sig90pctCI"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Variable</th>
<th align="left">Value</th>
<th align="right">orMean</th>
<th align="right">or90CILB</th>
<th align="right">or90CIUB</th>
<th align="left">sig90pctCI</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Z1</td>
<td align="left">0</td>
<td align="right">1.00</td>
<td align="right">NaN</td>
<td align="right">NaN</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">Z1</td>
<td align="left">1</td>
<td align="right">1.13</td>
<td align="right">0.6638778</td>
<td align="right">1.9215158</td>
<td align="left">Not significant</td>
</tr>
<tr class="odd">
<td align="left">Z2</td>
<td align="left">0</td>
<td align="right">1.00</td>
<td align="right">NaN</td>
<td align="right">NaN</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">Z2</td>
<td align="left">1</td>
<td align="right">2.04</td>
<td align="right">1.1607575</td>
<td align="right">3.5807363</td>
<td align="left">Significant</td>
</tr>
<tr class="odd">
<td align="left">Z3</td>
<td align="left">1</td>
<td align="right">1.00</td>
<td align="right">NaN</td>
<td align="right">NaN</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">Z3</td>
<td align="left">2</td>
<td align="right">1.24</td>
<td align="right">0.6182017</td>
<td align="right">2.4900323</td>
<td align="left">Not significant</td>
</tr>
<tr class="odd">
<td align="left">Z3</td>
<td align="left">3</td>
<td align="right">1.07</td>
<td align="right">0.5623750</td>
<td align="right">2.0241972</td>
<td align="left">Not significant</td>
</tr>
<tr class="even">
<td align="left">Z3</td>
<td align="left">4</td>
<td align="right">0.79</td>
<td align="right">0.3797575</td>
<td align="right">1.6376455</td>
<td align="left">Not significant</td>
</tr>
<tr class="odd">
<td align="left">Z4</td>
<td align="left">1</td>
<td align="right">1.00</td>
<td align="right">NaN</td>
<td align="right">NaN</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">Z4</td>
<td align="left">2</td>
<td align="right">0.61</td>
<td align="right">0.3613764</td>
<td align="right">1.0195813</td>
<td align="left">Not significant</td>
</tr>
<tr class="odd">
<td align="left">Z4</td>
<td align="left">3</td>
<td align="right">0.21</td>
<td align="right">0.0853616</td>
<td align="right">0.5404608</td>
<td align="left">Significant</td>
</tr>
<tr class="even">
<td align="left">timeCat</td>
<td align="left">1</td>
<td align="right">1.00</td>
<td align="right">NaN</td>
<td align="right">NaN</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">timeCat</td>
<td align="left">2</td>
<td align="right">0.70</td>
<td align="right">0.3616349</td>
<td align="right">1.3558591</td>
<td align="left">Not significant</td>
</tr>
<tr class="even">
<td align="left">timeCat</td>
<td align="left">3</td>
<td align="right">0.51</td>
<td align="right">0.2208150</td>
<td align="right">1.1901120</td>
<td align="left">Not significant</td>
</tr>
<tr class="odd">
<td align="left">timeCat</td>
<td align="left">4</td>
<td align="right">0.30</td>
<td align="right">0.1115102</td>
<td align="right">0.7948653</td>
<td align="left">Significant</td>
</tr>
<tr class="even">
<td align="left">timeCat</td>
<td align="left">5</td>
<td align="right">0.12</td>
<td align="right">0.0252413</td>
<td align="right">0.5624551</td>
<td align="left">Significant</td>
</tr>
<tr class="odd">
<td align="left">timeCat</td>
<td align="left">6</td>
<td align="right">0.13</td>
<td align="right">0.0525507</td>
<td align="right">0.3190950</td>
<td align="left">Significant</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="running-the-adjusted-model">Running the adjusted model<a class="anchor" aria-label="anchor" href="#running-the-adjusted-model"></a>
</h2>
<p>We again call nbProbabilities to run our adjusted model. Note two
changes from the first time we ran this function:</p>
<ul>
<li>orType now is set to “adjusted”</li>
<li>covariates only includes the variables we found to be significant at
the 0.1 level</li>
</ul>
<p>We also now include the argument nBS to specify the number of
bootstrap samples ran in each cross-validation fold. <strong>In this
tutorial, nBS = 10 for computation speed but should be at least 100 in
practice.</strong></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adjRes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nbProbabilities.html">nbProbabilities</a></span><span class="op">(</span>orderedPair <span class="op">=</span> <span class="va">pairDataOrdered</span>,</span>
<span>                            indIDVar <span class="op">=</span> <span class="st">"individualID"</span>,</span>
<span>                            pairIDVar <span class="op">=</span> <span class="st">"pairID"</span>,</span>
<span>                            goldStdVar <span class="op">=</span> <span class="st">"snpClose"</span>,</span>
<span>                            covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Z2"</span>, <span class="st">"Z4"</span>, <span class="st">"timeCat"</span><span class="op">)</span>,</span>
<span>                            label <span class="op">=</span> <span class="st">"SNPs"</span>, l <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                            n <span class="op">=</span> <span class="fl">5</span>, m <span class="op">=</span> <span class="fl">1</span>, nReps <span class="op">=</span> <span class="fl">5</span>, </span>
<span>                            orType <span class="op">=</span> <span class="st">"adjusted"</span>, nBS <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>We again can look at the output in table form.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Exponentiating the log odds ratios and creating a table of odds ratios</span></span>
<span><span class="va">orTabAdj</span> <span class="op">&lt;-</span> <span class="va">adjRes</span><span class="op">$</span><span class="va">estimates</span></span>
<span><span class="va">orTabAdj</span> <span class="op">&lt;-</span> <span class="va">orTabAdj</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">orTabAdj</span><span class="op">$</span><span class="va">level</span> <span class="op">==</span> <span class="st">"(Intercept)"</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">orTabAdj</span><span class="op">$</span><span class="va">orMean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">orTabAdj</span><span class="op">$</span><span class="va">logorMean</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">orTabAdj</span><span class="op">$</span><span class="va">orCILB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">orTabAdj</span><span class="op">$</span><span class="va">logorCILB</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">orTabAdj</span><span class="op">$</span><span class="va">orCIUB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">orTabAdj</span><span class="op">$</span><span class="va">logorCIUB</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">orTabAdj</span><span class="op">$</span><span class="va">Variable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">orTabAdj</span><span class="op">$</span><span class="va">level</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">orTabAdj</span><span class="op">$</span><span class="va">level</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">orTabAdj</span><span class="op">$</span><span class="va">Value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">orTabAdj</span><span class="op">$</span><span class="va">level</span>, <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">orTabAdj</span><span class="op">$</span><span class="va">level</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">orTabAdj</span><span class="op">$</span><span class="va">level</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">orTabAdjPrint</span> <span class="op">&lt;-</span> <span class="va">orTabAdj</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Variable"</span>, <span class="st">"Value"</span>, <span class="st">"orMean"</span>, <span class="st">"orCILB"</span>, <span class="st">"orCIUB"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<div class="section level4">
<h4 id="table-of-contribution-of-covariates-1">Table of contribution of covariates<a class="anchor" aria-label="anchor" href="#table-of-contribution-of-covariates-1"></a>
</h4>
<table class="table">
<thead><tr class="header">
<th align="left">Variable</th>
<th align="left">Value</th>
<th align="right">orMean</th>
<th align="right">orCILB</th>
<th align="right">orCIUB</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">timeCat</td>
<td align="left">2</td>
<td align="right">0.82</td>
<td align="right">0.37</td>
<td align="right">1.84</td>
</tr>
<tr class="even">
<td align="left">timeCat</td>
<td align="left">3</td>
<td align="right">0.37</td>
<td align="right">0.01</td>
<td align="right">9.54</td>
</tr>
<tr class="odd">
<td align="left">timeCat</td>
<td align="left">4</td>
<td align="right">0.11</td>
<td align="right">0.00</td>
<td align="right">515.64</td>
</tr>
<tr class="even">
<td align="left">timeCat</td>
<td align="left">5</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">220.31</td>
</tr>
<tr class="odd">
<td align="left">timeCat</td>
<td align="left">6</td>
<td align="right">0.13</td>
<td align="right">0.01</td>
<td align="right">1.41</td>
</tr>
<tr class="even">
<td align="left">Z2</td>
<td align="left">1</td>
<td align="right">1.66</td>
<td align="right">0.81</td>
<td align="right">3.37</td>
</tr>
<tr class="odd">
<td align="left">Z4</td>
<td align="left">2</td>
<td align="right">0.60</td>
<td align="right">0.29</td>
<td align="right">1.26</td>
</tr>
<tr class="even">
<td align="left">Z4</td>
<td align="left">3</td>
<td align="right">0.11</td>
<td align="right">0.00</td>
<td align="right">17.27</td>
</tr>
</tbody>
</table>
<p>The odds ratio describing the association between being a link and
having a timeCat value of 5 (time between cases of 4-5 years) has a very
large confidence interval upper bound. This is due to their being very
few instances of transmission in this category, which leads to
instability in the standard error calculation in the logistic
regression.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">pairDataOrdered</span><span class="op">$</span><span class="va">timeCat</span>, <span class="va">pairDataOrdered</span><span class="op">$</span><span class="va">snpClose</span><span class="op">)</span></span>
<span><span class="co">#&gt;    </span></span>
<span><span class="co">#&gt;     FALSE TRUE</span></span>
<span><span class="co">#&gt;   1   290   94</span></span>
<span><span class="co">#&gt;   2   239   58</span></span>
<span><span class="co">#&gt;   3   215   37</span></span>
<span><span class="co">#&gt;   4   170   18</span></span>
<span><span class="co">#&gt;   5   146    6</span></span>
<span><span class="co">#&gt;   6   407   34</span></span></code></pre></div>
<p>If this occurs, one may consider other categorizations such that
these small sample sizes do not occur. Here, we can combine categories 5
and 6 of timeCat:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pairDataOrdered</span><span class="op">$</span><span class="va">timeCat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">pairDataOrdered</span><span class="op">$</span><span class="va">timeCat</span> <span class="op">==</span> <span class="fl">6</span>, <span class="fl">5</span>, <span class="va">pairDataOrdered</span><span class="op">$</span><span class="va">timeCat</span> <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can then rerun the model to see this issue has been fixed.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adjRes2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nbProbabilities.html">nbProbabilities</a></span><span class="op">(</span>orderedPair <span class="op">=</span> <span class="va">pairDataOrdered</span>,</span>
<span>                            indIDVar <span class="op">=</span> <span class="st">"individualID"</span>,</span>
<span>                            pairIDVar <span class="op">=</span> <span class="st">"pairID"</span>,</span>
<span>                            goldStdVar <span class="op">=</span> <span class="st">"snpClose"</span>,</span>
<span>                            covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Z2"</span>, <span class="st">"Z4"</span>, <span class="st">"timeCat2"</span><span class="op">)</span>,</span>
<span>                            label <span class="op">=</span> <span class="st">"SNPs"</span>, l <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                            n <span class="op">=</span> <span class="fl">5</span>, m <span class="op">=</span> <span class="fl">1</span>, nReps <span class="op">=</span> <span class="fl">5</span>, </span>
<span>                            orType <span class="op">=</span> <span class="st">"adjusted"</span>, nBS <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">orTabAdj2</span> <span class="op">&lt;-</span> <span class="va">adjRes2</span><span class="op">$</span><span class="va">estimates</span></span>
<span><span class="va">orTabAdj2</span> <span class="op">&lt;-</span> <span class="va">orTabAdj2</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">orTabAdj2</span><span class="op">$</span><span class="va">level</span> <span class="op">==</span> <span class="st">"(Intercept)"</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">orTabAdj2</span><span class="op">$</span><span class="va">orMean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">orTabAdj2</span><span class="op">$</span><span class="va">logorMean</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">orTabAdj2</span><span class="op">$</span><span class="va">orCILB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">orTabAdj2</span><span class="op">$</span><span class="va">logorCILB</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">orTabAdj2</span><span class="op">$</span><span class="va">orCIUB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">orTabAdj2</span><span class="op">$</span><span class="va">logorCIUB</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">orTabAdj2</span><span class="op">$</span><span class="va">Variable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">orTabAdj2</span><span class="op">$</span><span class="va">level</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">orTabAdj2</span><span class="op">$</span><span class="va">level</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">orTabAdj2</span><span class="op">$</span><span class="va">Value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">orTabAdj2</span><span class="op">$</span><span class="va">level</span>, <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">orTabAdj2</span><span class="op">$</span><span class="va">level</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">orTabAdj2</span><span class="op">$</span><span class="va">level</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">orTabAdjPrint2</span> <span class="op">&lt;-</span> <span class="va">orTabAdj2</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Variable"</span>, <span class="st">"Value"</span>, <span class="st">"orMean"</span>, <span class="st">"orCILB"</span>, <span class="st">"orCIUB"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Variable</th>
<th align="left">Value</th>
<th align="right">orMean</th>
<th align="right">orCILB</th>
<th align="right">orCIUB</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">timeCat2</td>
<td align="left">2</td>
<td align="right">0.70</td>
<td align="right">0.28</td>
<td align="right">1.75</td>
</tr>
<tr class="even">
<td align="left">timeCat2</td>
<td align="left">3</td>
<td align="right">0.52</td>
<td align="right">0.15</td>
<td align="right">1.81</td>
</tr>
<tr class="odd">
<td align="left">timeCat2</td>
<td align="left">4</td>
<td align="right">0.18</td>
<td align="right">0.00</td>
<td align="right">35.18</td>
</tr>
<tr class="even">
<td align="left">timeCat2</td>
<td align="left">5</td>
<td align="right">0.11</td>
<td align="right">0.03</td>
<td align="right">0.39</td>
</tr>
<tr class="odd">
<td align="left">Z2</td>
<td align="left">1</td>
<td align="right">1.71</td>
<td align="right">0.81</td>
<td align="right">3.62</td>
</tr>
<tr class="even">
<td align="left">Z4</td>
<td align="left">2</td>
<td align="right">0.61</td>
<td align="right">0.30</td>
<td align="right">1.25</td>
</tr>
<tr class="odd">
<td align="left">Z4</td>
<td align="left">3</td>
<td align="right">0.10</td>
<td align="right">0.00</td>
<td align="right">10.48</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>In this tutorial, we have illustrated how to use the nbTransmission
package to model adjusted odds ratios describing the association between
covariates and a variable representing transmission.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Sarah V Leavitt, Anne Shapiro.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
