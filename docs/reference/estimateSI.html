<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimates the generation/serial interval distribution — estimateSI • nbTransmission</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Estimates the generation/serial interval distribution — estimateSI"><meta property="og:description" content="The function estimateSI uses the relative transmission probabilities to estimate
the generation/serial interval distribution assuming a gamma distribution.
It uses the PEM algorithm developed by Hens et al. 2012 extending their method to include
restricting analysis to the top cluster of possible infectors."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nbTransmission</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/adjusted-odds-ratio-example-vignette.html">Adjusted Odds Ratio Example</a>
    </li>
    <li>
      <a href="../articles/nbTransmission-vignette.html">Introductory tutorial for R Package nbTransmission</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/sarahleavitt/nbTransmission/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimates the generation/serial interval distribution</h1>
    <small class="dont-index">Source: <a href="https://github.com/sarahleavitt/nbTransmission/blob/HEAD/R/calcSI.R" class="external-link"><code>R/calcSI.R</code></a></small>
    <div class="hidden name"><code>estimateSI.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function <code>estimateSI</code> uses the relative transmission probabilities to estimate
the generation/serial interval distribution assuming a gamma distribution.
It uses the PEM algorithm developed by Hens et al. 2012 extending their method to include
restricting analysis to the top cluster of possible infectors.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">estimateSI</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  <span class="va">indIDVar</span>,</span>
<span>  <span class="va">timeDiffVar</span>,</span>
<span>  <span class="va">pVar</span>,</span>
<span>  clustMethod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"n"</span>, <span class="st">"kd"</span>, <span class="st">"hc_absolute"</span>, <span class="st">"hc_relative"</span><span class="op">)</span>,</span>
<span>  cutoffs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">initialPars</span>,</span>
<span>  shift <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  epsilon <span class="op">=</span> <span class="fl">1e-05</span>,</span>
<span>  bootSamples <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  progressBar <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>df</dt>
<dd><p>The name of the dateset with transmission probabilities (column <code>pVar</code>),
individual IDs (columns <code>&lt;indIDVar&gt;.1</code> and <code>&lt;indIDVar&gt;.2</code>), and difference
in time between the pair of cases (column <code>timeDiffVar</code>)</p></dd>


<dt>indIDVar</dt>
<dd><p>The name (in quotes) of the individual ID columns
(data frame <code>df</code> must have variables called <code>&lt;indIDVar&gt;.1</code>
 and <code>&lt;indIDVar&gt;.2</code>).</p></dd>


<dt>timeDiffVar</dt>
<dd><p>The name (in quotes) of the column with the difference
in time between infection (generation interval) or symptom onset (serial interval) for the
pair of cases. The units of this variable (hours, days, years) defines the units of the 
resulting distribution.</p></dd>


<dt>pVar</dt>
<dd><p>The column name (in quotes) of the transmission probabilities.</p></dd>


<dt>clustMethod</dt>
<dd><p>The method used to cluster the infectors; one of 
<code>"none", "n", "kd", "hc_absolute", "hc_relative"</code> where <code>"none"</code> or
not specifying a value means use all pairs with no clustering
(see <code><a href="clusterInfectors.html">clusterInfectors</a></code> for detials on clustering methods).</p></dd>


<dt>cutoffs</dt>
<dd><p>A vector of cutoffs for clustering (see <code><a href="clusterInfectors.html">clusterInfectors</a></code>).
If more than one cutoff is provided, a pooled estimate will also be provided.</p></dd>


<dt>initialPars</dt>
<dd><p>A vector of length two with the shape and scale 
to initialize the gamma distribution parameters.</p></dd>


<dt>shift</dt>
<dd><p>A value in the same units as <code>timeDiffVar</code> that the
gamma distribution should be shifted. The default value of 0 is an 
unmodifed gamma distribution.</p></dd>


<dt>epsilon</dt>
<dd><p>The difference between successive estimates of the shape and
scale parameters that indicates convergence.</p></dd>


<dt>bootSamples</dt>
<dd><p>The number of bootstrap samples; if 0, then no confidence intervals
are calculated.</p></dd>


<dt>alpha</dt>
<dd><p>The alpha level for the confidence intervals.</p></dd>


<dt>progressBar</dt>
<dd><p>A logical indicating if a progress bar should be printed (default is TRUE).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A data frame with one row and the following columns:</p><ul><li><p><code>nIndividuals</code> - the number of infectees who have intervals included in the estimate.</p></li>
<li><p><code>pCluster</code> - the proportion of cases who have intervals included in the estimate.</p></li>
<li><p><code>nInfectors</code> - the average number of infectors in the top cluster.</p></li>
<li><p><code>shape</code> - the shape of the estimated gamma distribution for the interval</p></li>
<li><p><code>scale</code> - the scale of the estimated gamma distribution for the interval</p></li>
<li><p><code>meanSI</code> - the mean of the estimated gamma distribution for the interval 
   (<code>shape * scale + shift</code>)</p></li>
<li><p><code>medianSI</code> - the median of the estimated gamma distribution for the interval
   (<code>qgamma(0.5, shape, scale) + shift)</code>)</p></li>
<li><p><code>sdSI</code> - the standard deviation of the estimated gamma distribution for
   the interval (<code>shape * scale ^ 2</code>)</p></li>
</ul><p>If bootSamples &gt; 0, then the data frame also includes the following columns:</p>
<p></p>
<ul><li><p><code>shapeCILB</code> and <code>shapeCIUB</code> - lower bound and upper bounds
    of the bootstrap confidence interval for the shape parameter</p></li>
<li><p><code>scaleCILB</code> and <code>scaleCIUB</code> - lower bound and upper bounds
    of the bootstrap confidence interval for the scale parameter</p></li>
<li><p><code>meanCILB</code> and <code>meanCIUB</code> - lower bound and upper bounds
    of the bootstrap confidence interval for the mean of the interval distribution</p></li>
<li><p><code>medianCILB</code> and <code>medianCIUB</code> - lower bound and upper bounds
    of the bootstrap confidence interval for the median of the interval distribution</p></li>
<li><p><code>sdCILB</code> and <code>sdCIUB</code> - lower bound and upper bounds
    of the bootstrap confidence interval for the sd of the interval distribution</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>The PEM algorithm uses the prior probability that each pair is connected by direct
transmission to estimate the generation/serial interval using estimation maximization.
This code will provide an estimate of the generation interval if <code>timeDiffVar</code> represents the
difference in infection dates and the serial interval if it represents the difference in symptom onset dates.
The current generation/serial interval distribution parameters are used to update the probabilities
which are then used to update the generation/serial interval distribution parameters. The process
continues until the parameters converge (indicated by a change of less than <code>epsilon</code>)
between iterations. <em>Note: time difference between pairs should not be used to 
estimate the probabilities</em></p>
<p>This function acts as a wrapper around <code><a href="performPEM.html">performPEM</a></code> which integrates
estimation of the generation/serial interval distribution with clustering the infectors and calculates
derived parameters (mean, median, sd) of the distribution. Generally, this function
should be called instead of <code><a href="performPEM.html">performPEM</a></code> directly.</p>
<p>All pairs of cases can be used in the estimation process by setting
<code>clustMethod = "none"</code>. However, if the probabilities are from a algorithm such as
<code><a href="nbProbabilities.html">nbProbabilities</a></code>, then it is recommeneded to use a clustering method
and only include the top cluster of infectors for infectees which have such a cluster.
This can be specified by using the <code>clustMethod</code> and <code>cutoff</code> arguments which
are passed into <code><a href="clusterInfectors.html">clusterInfectors</a></code>. See the details of this function for
a description of the different clustering methods.</p>
<p>The method can be performed with any generation/serial interval distribution,
but this version of this function assumes that the generation/serial interval has a gamma distribution.
The function does allow for a shifted gamma distribution. The <code>shift</code> argument
defines how much the gamma distribution should be shifted. Any observed generation/serial intervals
that are less than this shift will have probability 0. This parameter should be used if 
there is a clinical lower bound for the possible generation/serial interval. If this argument
is not specified then an unmodified gamma function is used. The units of the
estimated gamma distribution will be defined by the units of the provided
<code>&lt;timeDiffVar&gt;</code> column. The value of the <code>shift</code> should be in the same units.</p>
<p>The algorithm requires initial parameters which should be specified as a vector: 
<code>c(&lt;shape&gt;, &lt;scale&gt;)</code>. These parameters should result in a gamma distribution
that is on the desired scale, set by the <code>&lt;timeDiffVar&gt;</code> column.</p>
<p>If <code>bootSamples &gt; 0</code>, bootstrap confidence intervals will be estimated for
both the shape and scale parameters as well as the mean, median, and mode of the
distribution using cluster bootstrapping.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Hens N, Calatayud L, Kurkela S, Tamme T, Wallinga J. Robust reconstruction and
analysis of outbreak data: influenza A (H1N1) v transmission in a school-based 
population. <em>American Journal of Epidemiology</em>. 2012 Jul 12;176(3):196-203.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="nbProbabilities.html">nbProbabilities</a></code> <code><a href="clusterInfectors.html">clusterInfectors</a></code>
 <code><a href="performPEM.html">performPEM</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## First, run the algorithm without including time as a covariate.</span></span></span>
<span class="r-in"><span><span class="va">orderedPair</span> <span class="op">&lt;-</span> <span class="va">pairData</span><span class="op">[</span><span class="va">pairData</span><span class="op">$</span><span class="va">infectionDiffY</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create a variable called snpClose that will define probable links</span></span></span>
<span class="r-in"><span><span class="co"># (&lt;3 SNPs) and nonlinks (&gt;12 SNPs) all pairs with between 2-12 SNPs</span></span></span>
<span class="r-in"><span><span class="co"># will not be used to train.</span></span></span>
<span class="r-in"><span><span class="va">orderedPair</span><span class="op">$</span><span class="va">snpClose</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">orderedPair</span><span class="op">$</span><span class="va">snpDist</span> <span class="op">&lt;</span> <span class="fl">3</span>, <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                        <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">orderedPair</span><span class="op">$</span><span class="va">snpDist</span> <span class="op">&gt;</span> <span class="fl">12</span>, <span class="cn">FALSE</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">orderedPair</span><span class="op">$</span><span class="va">snpClose</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FALSE  TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   881   246 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Running the algorithm</span></span></span>
<span class="r-in"><span><span class="co"># NOTE should run with nReps &gt; 1.</span></span></span>
<span class="r-in"><span><span class="va">resGen</span> <span class="op">&lt;-</span> <span class="fu"><a href="nbProbabilities.html">nbProbabilities</a></span><span class="op">(</span>orderedPair <span class="op">=</span> <span class="va">orderedPair</span>,</span></span>
<span class="r-in"><span>                            indIDVar <span class="op">=</span> <span class="st">"individualID"</span>,</span></span>
<span class="r-in"><span>                            pairIDVar <span class="op">=</span> <span class="st">"pairID"</span>,</span></span>
<span class="r-in"><span>                            goldStdVar <span class="op">=</span> <span class="st">"snpClose"</span>,</span></span>
<span class="r-in"><span>                            covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Z1"</span>, <span class="st">"Z2"</span>, <span class="st">"Z3"</span>, <span class="st">"Z4"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            label <span class="op">=</span> <span class="st">"SNPs"</span>, l <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                            n <span class="op">=</span> <span class="fl">10</span>, m <span class="op">=</span> <span class="fl">1</span>, nReps <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span>                            </span></span>
<span class="r-in"><span><span class="co">## Merging the probabilities back with the pair-level data</span></span></span>
<span class="r-in"><span><span class="va">nbResultsNoT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">resGen</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">orderedPair</span>, by <span class="op">=</span> <span class="st">"pairID"</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Estimating the serial interval</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using hierarchical clustering with a 0.05 absolute difference cutoff</span></span></span>
<span class="r-in"><span><span class="fu">estimateSI</span><span class="op">(</span><span class="va">nbResultsNoT</span>, indIDVar <span class="op">=</span> <span class="st">"individualID"</span>,</span></span>
<span class="r-in"><span>             timeDiffVar <span class="op">=</span> <span class="st">"infectionDiffY"</span>, pVar <span class="op">=</span> <span class="st">"pScaled"</span>,</span></span>
<span class="r-in"><span>             clustMethod <span class="op">=</span> <span class="st">"hc_absolute"</span>, cutoff <span class="op">=</span> <span class="fl">0.05</span>, initialPars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   clustMethod cutoff nIndividuals nInfectors  pCluster    shape    scale</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 hc_absolute   0.05           78   1.012821 0.7878788 1.190383 1.667412</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     meanSI medianSI     sdSI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1.984859 1.464863 1.819225</span>
<span class="r-in"><span>             </span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Using all pairs</span></span></span>
<span class="r-in"><span><span class="fu">estimateSI</span><span class="op">(</span><span class="va">nbResultsNoT</span>, indIDVar <span class="op">=</span> <span class="st">"individualID"</span>,</span></span>
<span class="r-in"><span>              timeDiffVar <span class="op">=</span> <span class="st">"infectionDiffY"</span>, pVar <span class="op">=</span> <span class="st">"pScaled"</span>,</span></span>
<span class="r-in"><span>              clustMethod <span class="op">=</span> <span class="st">"none"</span>, initialPars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   clustMethod cutoff nIndividuals nInfectors pCluster    shape     scale meanSI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        none   none           99    49.9899        1 1.435021 0.7401288 1.0621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   medianSI      sdSI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.828117 0.8866176</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># # Using a shifted gamma distribution:</span></span></span>
<span class="r-in"><span><span class="co"># # not allowing serial intervals of less than 3 months (0.25 years)</span></span></span>
<span class="r-in"><span><span class="fu">estimateSI</span><span class="op">(</span><span class="va">nbResultsNoT</span>, indIDVar <span class="op">=</span> <span class="st">"individualID"</span>,</span></span>
<span class="r-in"><span>              timeDiffVar <span class="op">=</span> <span class="st">"infectionDiffY"</span>, pVar <span class="op">=</span> <span class="st">"pScaled"</span>,</span></span>
<span class="r-in"><span>              clustMethod <span class="op">=</span> <span class="st">"hc_absolute"</span>, cutoff <span class="op">=</span> <span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>              initialPars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, shift <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   clustMethod cutoff nIndividuals nInfectors  pCluster    shape    scale</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 hc_absolute   0.05           78   1.012821 0.7878788 1.273929 1.549818</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     meanSI medianSI     sdSI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2.224358 1.738445 1.749256</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># # Using multiple cutoffs</span></span></span>
<span class="r-in"><span><span class="fu">estimateSI</span><span class="op">(</span><span class="va">nbResultsNoT</span>, indIDVar <span class="op">=</span> <span class="st">"individualID"</span>,</span></span>
<span class="r-in"><span>              timeDiffVar <span class="op">=</span> <span class="st">"infectionDiffY"</span>, pVar <span class="op">=</span> <span class="st">"pScaled"</span>,</span></span>
<span class="r-in"><span>              clustMethod <span class="op">=</span> <span class="st">"hc_absolute"</span>, cutoff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.05</span><span class="op">)</span>, initialPars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   clustMethod cutoff nIndividuals nInfectors  pCluster    shape    scale</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 hc_absolute  0.025           84   1.142857 0.8484848 1.165297 1.702207</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 hc_absolute   0.05           78   1.012821 0.7878788 1.190383 1.667412</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 hc_absolute pooled           NA         NA        NA       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     meanSI medianSI     sdSI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1.983576 1.453673 1.837514</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1.984859 1.464863 1.819225</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 1.984218 1.459268 1.828369</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Adding confidence intervals</span></span></span>
<span class="r-in"><span><span class="co"># NOTE should run with bootSamples &gt; 2.</span></span></span>
<span class="r-in"><span><span class="fu">estimateSI</span><span class="op">(</span><span class="va">nbResultsNoT</span>, indIDVar <span class="op">=</span> <span class="st">"individualID"</span>,</span></span>
<span class="r-in"><span>             timeDiffVar <span class="op">=</span> <span class="st">"infectionDiffY"</span>, pVar <span class="op">=</span> <span class="st">"pScaled"</span>,</span></span>
<span class="r-in"><span>             clustMethod <span class="op">=</span> <span class="st">"hc_absolute"</span>, cutoff <span class="op">=</span> <span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>             initialPars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, shift <span class="op">=</span> <span class="fl">0.25</span>, bootSamples <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%  |                                                                              |                                                                      |   0%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   clustMethod cutoff nIndividuals nInfectors  pCluster    shape    scale</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 hc_absolute   0.05           78   1.012821 0.7878788 1.273929 1.549818</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     meanSI medianSI     sdSI shapeCILB shapeCIUB scaleCILB scaleCIUB meanCILB</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2.224358 1.738445 1.749256  1.160396  1.408723  1.188316   1.63125 2.024435</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   meanCIUB medianCILB medianCIUB   sdCILB  sdCIUB</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2.164357   1.646329   1.655623 1.460173 1.77042</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sarah V Leavitt, Anne Shapiro.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

